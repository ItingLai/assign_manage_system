import{F as p,i as v}from"./index-710185f6.js";import{i as g}from"./index-b4cf4bd5.js";import{o as r,c as h}from"./loading-bf393b7e.js";import{d as f,r as o,o as m,w as C,a as A,c as F,b as k,u as x,E as i,i as y}from"./index-2d2b0b3d.js";const Y=f({__name:"attendSheet",setup(w){const a=o(null),l=o(""),c=o(null),n=()=>{d(),r(),fetch(`api/getAttendSheet?month=${l.value}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.code===200?(c.value=e.data,e.data.forEach(t=>{s(t)})):i.error("資料取得失敗")}).catch(()=>{i.error("資料取得失敗")}).finally(()=>{h()})},s=e=>{a.value.getApi().addEvent({title:e.name,date:e.date,allDay:!0,color:e.type==="attend"?"#67C23A":"#FF4FFF"})},d=()=>{let e=a.value.getApi().getEvents();e&&e.length>0&&e.map(t=>{a.value.getApi().getEventById(t.id).remove()})},u={plugins:[v,g],selectable:!0,initialView:"dayGridMonth",locale:"zh-tw",buttonText:{today:"今天"},customButtons:{prev:{text:"上個月",click:()=>{let e=a.value.getApi();e.prev();let t=new Date(e.view.currentStart);l.value=t.getFullYear()+"-"+(t.getMonth()+1),n()}},next:{text:"下個月",click:()=>{let e=a.value.getApi();e.next();let t=new Date(e.view.currentStart);l.value=t.getFullYear()+"-"+(t.getMonth()+1),n()}},today:{text:"當月",click:()=>{let e=a.value.getApi();e.today();let t=new Date(e.view.currentStart);l.value=t.getFullYear()+"-"+(t.getMonth()+1),n()}}},events:[]};return m(()=>{r();let e=new Date;e.setHours(0,0,0,0),l.value=`${e.getFullYear()}-${e.getMonth()+1}`,n()}),C(y,()=>{setTimeout(()=>{a.value.getApi().updateSize()},500)}),(e,t)=>(A(),F("div",null,[k(x(p),{ref_key:"fullCalendar",ref:a,options:u},null,512)]))}});export{Y as default};
